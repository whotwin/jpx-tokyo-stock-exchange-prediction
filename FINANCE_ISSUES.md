# JPX 股票预测项目 - 金融核心问题总结

## 项目背景

本项目旨在预测日本东京证券交易所(JPX)股票的预期收益率，用于构建投资组合。核心目标是区分"好股票"和"差股票"，通过多空组合获取超额收益。

---

## 一、预测期限 (Horizon) 问题

### 核心问题
应该预测多长时间后的收益？

| 期限 | 优点 | 缺点 |
|------|------|------|
| 1天 | 数据量大，信号新 | 噪声大，难以预测 |
| 5天 | 平衡点 | 中等噪声 |
| 20天 | 信号稳定 | 数据点少，可能错过短期机会 |

### 关键结论
- **20天 horizon 表现最好**：RankIC 达到 0.061，远高于 1天的 0.023
- **原因**：长期信号更稳定，机构投资者调仓周期通常为月频

---

## 二、调仓锁定 (Lock Period) 问题

### 核心问题
预测 20 天后的收益，是否应该锁定持仓 20 天不允许换仓？

### 当前实现
- ✅ 强制 20 天锁定：不提前换仓
- ✅ 调仓频率 = 预测 horizon
- ❌ 不允许提前平仓或止损

### 待确认问题
1. **是否应该允许止损？** 现实中可以设定止损线
2. **是否应该允许止盈？** 达到目标收益后可以平仓
3. **锁定期间是否保持固定权重？** 还是应该动态再平衡？

---

## 三、收益计算方式问题

### 核心问题
如何累积收益？

| 方式 | 公式 | 特点 |
|------|------|------|
| 复利 (Compounding) | (1+r1)*(1*r2)-1 | 符合实际盈亏 |
| 简单叠加 (Simple) | r1 + r2 | 保守估计 |

### 当前实现
- 使用**简单叠加**方式（不复利）
- 原因：避免复利放大带来的虚假高收益

### 待确认问题
1. **哪种方式更符合实际？** 实际交易中利润会再投资
2. **是否应该扣除资金成本？** 融券需要支付利息

---

## 四、重叠收益 (Overlapping Returns) 问题

### 核心问题
对于 20 天预测，每天都用当天收益计算组合表现，是否合理？

### 问题说明
- 预测 20 天后的收益：price(t+20) / price(t) - 1
- 但组合每天计算：price(t+1) / price(t) - 1
- **时间不匹配**：20 天预测被短期收益"稀释"了

### 当前实现
- 调仓频率改为每月一次（与 20 天 horizon 匹配）
- 仅在调仓日重新计算组合权重

### 待确认问题
1. **是否应该在锁定期间完全不调仓？** 当前实现是
2. **锁定期间是否应该只计算一次收益？** 即持有 20 天后一次性计算

---

## 五、交易成本问题

### 当前设置
- 交易费率：0.0004 (万4)
- 滑点率：0.0002 (万2)
- 每次调仓双倍扣除（买+卖）

### 待确认问题
1. **费率是否合理？** 日本股票实际费率可能不同
2. **是否应该考虑冲击成本？** 大额交易会推动价格
3. **是否应该考虑融券成本？** 做空需要借券费用

---

## 六、数据源问题

### 核心问题
应该使用哪些数据？

| 数据源 | 说明 | 效果 |
|--------|------|------|
| stock_only | 仅股票价格 | 基准 |
| stock+all | +期权+交易+财务 | RankIC 提升 50%+ |

### 关键发现
- 加入期权数据 (Implied Volatility) 显著提升预测
- 投资者交易数据 (Foreigners, Individuals 买卖) 有预测价值
- 财务数据 (EPS, Profit) 有长期预测能力

### 待确认问题
1. **数据是否可能泄露？** 需要确保训练数据不包含测试期信息
2. **数据频率如何匹配？** 周频交易数据如何与日频股价对齐

---

## 七、组合构建问题

### 当前实现
- 多头 200 只 + 空头 200 只
- 等权重分配（多头 +0.5，空头 -0.5）
- 总暴露约 100%（市场中性的 Long/Short）

### 待确认问题
1. **是否应该加入市值/行业中性约束？** 减少系统性风险暴露
2. **是否应该加入波动率目标化？** 控制组合风险
3. **是否应该限制单票权重？** 避免集中风险
4. **做空是否应该限制比例？** 融券额度有限

---

## 八、时序对齐问题

### 核心问题
何时买入？何时卖出？

### 当前设置
- 预测：t+20 天收益
- 交易：在 t+1 日开盘买入（假设）

### 待确认问题
1. **是否考虑 T+1 制度？** 日本股市当日可买卖
2. **是否考虑流动性？** 小市值股票可能无法快速买入/卖出
3. **是否考虑交易时段？** 开盘/收盘交易有差异

---

## 九、模型评估问题

### 当前指标
- **RankIC**: 日频 Spearman 相关系数
- **Hit Ratio**: 预测方向准确率
- **Sharpe Ratio**: 风险调整收益
- **Max Drawdown**: 最大回撤

### 待确认问题
1. **是否应该使用年化收益？** 方便与其他策略比较
2. **是否应该考虑最大回撤持续时间？**
3. **是否应该计算 Calmar Ratio？** 收益/最大回撤

---

## 十、关键待确认清单

### 必须确认
- [ ] 20天锁定是否合理？是否允许提前止损/止盈？
- [ ] 简单收益 vs 复利，哪种更符合实际？
- [ ] 交易成本设置是否合理？

### 建议确认
- [ ] 是否加入市值/行业中性？
- [ ] 是否加入波动率目标化？
- [ ] 是否限制单票权重和杠杆？

### 可选优化
- [ ] 是否考虑冲击成本？
- [ ] 是否考虑融券成本？
- [ ] 是否考虑流动性约束？

---

## 总结

本项目的核心金融问题可以归纳为：

1. **投资期限匹配**：预测 horizon 应等于或接近锁定期
2. **收益计算真实**：避免复利带来的虚假高收益
3. **成本现实**：考虑交易成本、滑点、融券费用
4. **风险控制**：市值/行业中性、波动率目标、单票限制
5. **数据质量**：确保无未来函数泄露，使用多源数据

这些问题直接影响策略的实际可行性，需要根据实际交易环境进一步确认和优化。
